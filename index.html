<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focused Reading</title>
  <link rel="stylesheet" href="style.css">
  <script src="jszip.min.js"></script>
  <script type="importmap">
    {
      "imports": {
        "onnxruntime-web": "https://cdn.jsdelivr.net/npm/onnxruntime-web@1.18.0/dist/esm/ort.min.js"
      }
    }
  </script>
</head>
<body>
  <div id="app">
    <!-- Library View -->
    <div id="library-view" class="view active">
      <header class="library-header">
        <h1>Focused Reading</h1>
        <p class="subtitle">Speed read your books, one word at a time</p>
      </header>
      <div class="library-actions">
        <label class="import-btn" for="epub-input">
          + Add Book
          <input type="file" id="epub-input" accept=".epub" hidden>
        </label>
      </div>
      <div id="book-grid" class="book-grid">
        <p class="empty-state">No books yet. Import an EPUB to get started.</p>
      </div>
    </div>

    <!-- Reader View -->
    <div id="reader-view" class="view">
      <div class="reader-layout">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
          <button id="back-to-library" class="back-btn">&larr; Library</button>
          <div id="book-info" class="book-info"></div>
          <div class="chapter-list">
            <h3>Chapters</h3>
            <ul id="chapter-list"></ul>
          </div>
        </aside>

        <!-- Main Reader -->
        <main class="reader-main">
          <button id="toggle-sidebar" class="toggle-sidebar-btn" title="Toggle sidebar">&#9776;</button>
          <div class="reader-display">
            <div class="progress-bar-container">
              <div id="progress-bar" class="progress-bar"></div>
            </div>
            <div id="word-display" class="word-display">
              <span id="current-word">Press Play to start</span>
            </div>
            <div id="chapter-label" class="chapter-label"></div>
          </div>
          <div class="reader-controls">
            <div class="speed-control">
              <label for="wpm-slider">Speed: <span id="wpm-value">300</span> WPM</label>
              <input type="range" id="wpm-slider" min="100" max="1000" step="25" value="300">
            </div>
            <div class="playback-controls">
              <button id="prev-btn" class="control-btn" title="Previous sentence">&#9664;&#9664;</button>
              <button id="play-btn" class="control-btn play-btn" title="Play/Pause">&#9654;</button>
              <button id="next-btn" class="control-btn" title="Next sentence">&#9654;&#9654;</button>
            </div>
            <div class="voice-controls">
              <div class="voice-mode-selector">
                <button class="voice-mode-btn active" data-mode="off">Off</button>
                <button class="voice-mode-btn" data-mode="browser">Browser</button>
                <button class="voice-mode-btn" data-mode="piper">Piper</button>
              </div>
              <select id="voice-select" class="voice-dropdown hidden"></select>
              <div id="piper-controls" class="piper-controls hidden">
                <select id="piper-voice-select" class="voice-dropdown">
                  <option value="en_US-amy-medium" data-label="Amy (US Female)">Amy (US Female)</option>
                  <option value="en_US-john-medium" data-label="John (US Male)">John (US Male)</option>
                  <option value="en_GB-alba-medium" data-label="Alba (UK Female)">Alba (UK Female)</option>
                  <option value="en_GB-alan-medium" data-label="Alan (UK Male)">Alan (UK Male)</option>
                </select>
                <button id="piper-download-btn" class="piper-download-btn">Download Voice</button>
              </div>
              <div id="piper-status" class="piper-status hidden">
                <div class="piper-progress-bar"><div id="piper-progress-fill" class="piper-progress-fill"></div></div>
                <span id="piper-status-text"></span>
              </div>
            </div>
            <div class="position-control">
              <input type="range" id="position-slider" min="0" max="100" value="0" step="1">
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
  <script src="app.js" type="module"></script>
</body>
</html>
